{{/* JavaScript partial with Hugo asset pipeline processing */}}
{{/* Bundle JavaScript assets for optimal loading and deployment */}}

{{/* Collect JavaScript assets for bundling */}}
{{ $jsAssets := slice }}

{{/* Theme switcher script */}}
{{ $themeScript := resources.Get "js/theme-switcher.js" }}
{{ if $themeScript }}
  {{ $jsAssets = $jsAssets | append $themeScript }}
{{ end }}

{{/* Accessibility enhancement script - Requirements 7.1, 7.2, 7.3, 7.4, 7.5 */}}
{{ $accessibilityScript := resources.Get "js/accessibility.js" }}
{{ if $accessibilityScript }}
  {{ $jsAssets = $jsAssets | append $accessibilityScript }}
{{ end }}

{{/* Process and bundle JavaScript assets */}}
{{ if $jsAssets }}
  {{ $bundled := $jsAssets | resources.Concat "js/main.js" }}
  {{ $opts := dict 
    "minify" (not hugo.IsDevelopment)
    "sourceMap" (cond hugo.IsDevelopment "external" "")
    "target" "es2018"
    "platform" "browser"
  }}
  {{ with $bundled | js.Build $opts }}
    {{ if hugo.IsDevelopment }}
      <script src="{{ .RelPermalink }}" defer></script>
    {{ else }}
      {{ with . | fingerprint "sha256" }}
        <script src="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous" defer></script>
      {{ end }}
    {{ end }}
  {{ end }}
{{ else }}
  {{/* Fallback inline script if no JavaScript assets found */}}
  <script>
    console.warn('No JavaScript assets found');
  </script>
{{ end }}